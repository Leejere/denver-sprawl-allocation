Traceback (most recent call last):
  File "C:\Users\leeje\OneDrive\G-4\land-use-env-modeling\assignments\sprawl-allocation\env\Lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\leeje\OneDrive\G-4\land-use-env-modeling\assignments\sprawl-allocation\env\Lib\site-packages\nbclient\client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leeje\OneDrive\G-4\land-use-env-modeling\assignments\sprawl-allocation\env\Lib\site-packages\jupyter_core\utils\__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leeje\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Users\leeje\OneDrive\G-4\land-use-env-modeling\assignments\sprawl-allocation\env\Lib\site-packages\nbclient\client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "C:\Users\leeje\OneDrive\G-4\land-use-env-modeling\assignments\sprawl-allocation\env\Lib\site-packages\nbclient\client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\leeje\OneDrive\G-4\land-use-env-modeling\assignments\sprawl-allocation\env\Lib\site-packages\nbclient\client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
fpr, tpr, thresholds = roc_curve(observed, predicted)
roc_auc = auc(fpr, tpr)

left = alt.Chart(pd.DataFrame({"FPR": fpr, "TPR": tpr})).mark_line().encode(
    x=alt.X("FPR", title="False Positive Rate"),
    y=alt.Y("TPR", title="True Positive Rate"),
    color=alt.value(palette_hero),
).properties(
    title=f"ROC Curve (AUC = {roc_auc:.2f})",
    width=200,
    height=200,
)

metric_by_threshold = pd.DataFrame({
    "threshold": thresholds,
    "sensitivity": tpr,
    "specificity": 1 - fpr,
}).melt(
    id_vars="threshold",
    value_vars=["sensitivity", "specificity"],
    var_name="metric",
).query("0 <= threshold <= 1").copy()

right = alt.Chart(metric_by_threshold).mark_line().encode(
    x=alt.X("threshold", title="Threshold", scale=alt.Scale(domain=[0, 1])),
    y=alt.Y("value", title="Value"),
    color=alt.Color(
        "metric", title="Metric",
        scale=alt.Scale(range=[palette_hero, palette_primary]),
    ),
).properties(
    title="Sensitivity and specificity by threshold",
    width=200,
    height=200,
)

left | right
------------------


[1;31m---------------------------------------------------------------------------[0m
[1;31mNameError[0m                                 Traceback (most recent call last)
Cell [1;32mIn[6], line 1[0m
[1;32m----> 1[0m fpr, tpr, thresholds [38;5;241m=[39m [43mroc_curve[49m(observed, predicted)
[0;32m      2[0m roc_auc [38;5;241m=[39m auc(fpr, tpr)
[0;32m      4[0m left [38;5;241m=[39m alt[38;5;241m.[39mChart(pd[38;5;241m.[39mDataFrame({[38;5;124m"[39m[38;5;124mFPR[39m[38;5;124m"[39m: fpr, [38;5;124m"[39m[38;5;124mTPR[39m[38;5;124m"[39m: tpr}))[38;5;241m.[39mmark_line()[38;5;241m.[39mencode(
[0;32m      5[0m     x[38;5;241m=[39malt[38;5;241m.[39mX([38;5;124m"[39m[38;5;124mFPR[39m[38;5;124m"[39m, title[38;5;241m=[39m[38;5;124m"[39m[38;5;124mFalse Positive Rate[39m[38;5;124m"[39m),
[0;32m      6[0m     y[38;5;241m=[39malt[38;5;241m.[39mY([38;5;124m"[39m[38;5;124mTPR[39m[38;5;124m"[39m, title[38;5;241m=[39m[38;5;124m"[39m[38;5;124mTrue Positive Rate[39m[38;5;124m"[39m),
[1;32m   (...)[0m
[0;32m     11[0m     height[38;5;241m=[39m[38;5;241m200[39m,
[0;32m     12[0m )

[1;31mNameError[0m: name 'roc_curve' is not defined

